<!DOCTYPE html>
<html lang="en" class="h-full bg-neutral-900 text-white">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Winston Scraper</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Winston AI Web Scraper" />
    <meta property="og:description" content="AI-powered contact extraction tool. Scrape emails, phone numbers, and contact info from any website in seconds. Export to CSV, Excel, or Google Sheets." />
    <meta property="og:url" content="https://scraper.winstonai.io" />
    <meta property="og:site_name" content="Winston AI" />
    <meta property="og:image" content="https://scraper.winstonai.io/winston-preview.svg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Winston AI Web Scraper" />
    <meta name="twitter:description" content="AI-powered contact extraction tool. Scrape emails, phone numbers, and contact info from any website in seconds." />
    <meta name="twitter:image" content="https://scraper.winstonai.io/winston-preview.svg" />
    
    <!-- Additional Meta Tags -->
    <meta name="description" content="AI-powered web scraper for contact extraction. Find emails, phone numbers, and contact info from any website. Export to CSV, Excel, or Google Sheets." />
    <meta name="keywords" content="web scraper, contact extraction, email finder, phone scraper, lead generation, AI scraper" />
    <meta name="author" content="Winston AI" />

    <!-- Tailwind (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Inter font -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap"
      rel="stylesheet"
    />

    <link rel="icon" href="/favicon.ico" />

    <!-- Winston Core Module -->
    <script src="/winston-core.js"></script>

    <style>
      body { font-family: 'Inter', sans-serif; }
      .gradient-bg {
        background: radial-gradient(110% 140% at 50% 0%,
          rgba(33,33,55,1) 0%,
          rgba(10,10,25,1) 60%,
          rgba(0,0,0,1) 100%);
      }
      /* Remove ALL button styling */
      button {
        background: none;
        border: none;
        outline: none;
        box-shadow: none;
        padding: 0;
        margin: 0;
      }
      button:focus, button:active, button:hover {
        outline: none !important;
        box-shadow: none !important;
        border: none !important;
        background: none !important;
      }
    </style>
  </head>

  <body class="flex flex-col min-h-full">
    <!-- Top nav -->
    <nav class="w-full bg-gray-900/95 backdrop-blur-md sticky top-0 z-50 border-b border-gray-800/50">
      <div class="mx-auto max-w-7xl flex items-center justify-between px-6 h-16">
        <div class="flex items-center space-x-3">
          <div id="winstonLogo" class="flex items-center space-x-2 text-lime-400 font-bold text-xl tracking-widest hover:text-lime-300 transition-colors duration-300 cursor-pointer">
            <span class="text-lime-400 text-2xl">ü§ñ</span>
            <span>WINSTON AI</span>
          </div>
          <span class="text-gray-400 text-sm font-medium hidden sm:block">
            Lead Intelligence Platform
          </span>
        </div>
        <div class="flex items-center space-x-4">
          <div class="text-xs text-gray-500 hidden md:block">
            v2.0
          </div>
        </div>
      </div>
    </nav>

    <!-- Hero / Scraper form -->
    <header class="flex-1 flex items-center justify-center py-20 px-4">
      <div
        class="gradient-bg rounded-3xl shadow-2xl max-w-5xl w-full px-8 md:px-12 py-16 text-center"
      >
        <div class="mb-8">
          <h1 class="text-4xl md:text-6xl font-extrabold mb-4 bg-gradient-to-r from-lime-400 to-green-400 bg-clip-text text-transparent">
            AI-Powered Lead Intelligence
        </h1>
          <h2 class="text-xl md:text-2xl font-semibold text-gray-300 mb-4">
            Find Investors, Partners & Customers in Seconds
          </h2>
        </div>
        <!-- Version: 2025-01-27 21:45 -->
        <div class="max-w-3xl mx-auto mb-10">
          <p class="text-gray-300 text-lg leading-relaxed mb-4">
            Discover high-quality leads with AI-powered categorization. Extract contact data from any source‚Äîstealth mode included.
          </p>
          <div class="flex flex-wrap justify-center gap-4 text-sm text-lime-300">
            <span class="flex items-center gap-1">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
              </svg>
              25+ AI Categories
            </span>
            <span class="flex items-center gap-1">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
              </svg>
              Batch Processing
            </span>
            <span class="flex items-center gap-1">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
              </svg>
              Export to Sheets
            </span>
          </div>
        </div>

        <div class="flex gap-4 mb-4 justify-center">
          <label class="flex items-center gap-1">
            <input type="radio" name="mode" value="keyword" checked />
            Single Keyword
          </label>
          <label class="flex items-center gap-1">
            <input type="radio" name="mode" value="batch" />
            üöÄ Batch Search
          </label>
          <label class="flex items-center gap-1">
            <input type="radio" name="mode" value="url" />
            Direct URL
          </label>
          <label class="flex items-center gap-1 text-sm">
            <input type="checkbox" id="emailToggle" checked />
            Include e-mails
          </label>
        </div>
        <div
          class="flex flex-col sm:flex-row gap-4 items-center justify-center mb-12"
        >
          <input
            id="urlInput"
            type="text"
            required
            placeholder="Enter keyword or URL"
            class="w-full sm:w-96 px-4 py-2 rounded-lg bg-white text-gray-900 border border-blue-400 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-400"
          />
          <textarea
            id="batchInput"
            placeholder="Enter keywords (one per line):&#10;women in stem investors&#10;female tech entrepreneurs&#10;diversity venture capital&#10;women startup founders&#10;female angel investors"
            class="hidden w-full sm:w-96 h-32 px-4 py-2 rounded-lg bg-white text-gray-900 border border-blue-400 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-400 resize-none"
          ></textarea>
          <button
            id="scrapeBtn"
            class="bg-lime-500 hover:bg-lime-400 text-gray-900 font-semibold px-6 py-2 rounded-lg transition disabled:opacity-50"
          >
            Scrape
          </button>
          <div id="exportDropdown" class="relative hidden">
            <button
              id="exportBtn"
              class="bg-transparent border border-lime-400 px-4 py-2 rounded-lg hover:bg-lime-400 hover:text-gray-900 transition flex items-center gap-2"
            >
              Export Data
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path>
              </svg>
            </button>
            <div id="exportMenu" class="absolute right-0 mt-2 w-48 bg-white text-gray-900 rounded-lg shadow-lg border border-gray-200 hidden">
              <button id="csvBtn" class="w-full text-left px-4 py-2 hover:bg-gray-100 rounded-t-lg flex items-center gap-2">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z"></path>
                </svg>
                Download CSV
              </button>
              <button id="xlsxBtn" class="w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center gap-2">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm3 2h6v2H7V5zm0 4h6v2H7V9zm0 4h6v2H7v-2z"></path>
                </svg>
                Download XLSX
              </button>
              <button id="sheetsBtn" class="w-full text-left px-4 py-2 hover:bg-gray-100 rounded-b-lg flex items-center gap-2">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"></path>
                </svg>
                Export to Sheets
              </button>
            </div>
          </div>
        </div>

        <!-- Results -->
        <section
          id="resultsWrapper"
          class="hidden bg-white text-gray-900 border border-blue-400 rounded-xl max-w-5xl mx-auto overflow-hidden"
                  >
            <div class="bg-white p-4 border-b border-gray-200 flex justify-between items-center">
              <h2 class="text-2xl font-bold text-gray-900">Contacts</h2>
              <div id="resultCount" class="text-sm text-gray-600 hidden">
                <span id="currentCount">0</span> contacts found
              </div>
            </div>
            <div
              id="resultsBox"
              class="bg-transparent"
            ></div>
            <div id="loadMoreSection" class="hidden p-4 text-center border-t border-gray-200">
              <button id="loadMoreBtn" class="bg-lime-500 hover:bg-lime-400 text-gray-900 font-semibold px-6 py-2 rounded-lg transition">
                Load More Results
              </button>
              <div class="text-xs text-gray-500 mt-2">
                Searching deeper for more contacts...
              </div>
            </div>
        </section>

        <!-- Loader -->
        <div id="loader" class="hidden mt-6">
          <div class="flex flex-col items-center space-y-4">
          <svg
              class="animate-spin h-10 w-10 text-lime-400"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
          >
            <circle
              class="opacity-25"
              cx="12"
              cy="12"
              r="10"
              stroke="currentColor"
              stroke-width="4"
            ></circle>
            <path
              class="opacity-75"
              fill="currentColor"
              d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"
            ></path>
          </svg>
            <div id="loadingText" class="text-lg font-medium text-lime-400 animate-pulse">
              Initializing search...
            </div>
            <div id="progressBar" class="w-64 h-2 bg-gray-700 rounded-full overflow-hidden">
              <div id="progressFill" class="h-full bg-gradient-to-r from-lime-400 to-green-500 transition-all duration-500 ease-out" style="width: 0%"></div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Footer -->
    <footer class="w-full py-4 text-center border-t border-gray-800/30">
      <div class="text-xs text-gray-500">
        Powered by <span class="text-gray-400 font-medium">CylonDigital</span>
      </div>
    </footer>

    <script>
      // Initialize Winston Scraper
      const winston = new WinstonScraper({
        maxBatchKeywords: 5
      });

      // DOM Elements
      const urlInput = document.getElementById('urlInput');
      const scrapeBtn = document.getElementById('scrapeBtn');
      const loader = document.getElementById('loader');
      const resultsWrapper = document.getElementById('resultsWrapper');
      const resultsBox = document.getElementById('resultsBox');
      const exportDropdown = document.getElementById('exportDropdown');
      const exportBtn = document.getElementById('exportBtn');
      const exportMenu = document.getElementById('exportMenu');
      const csvBtn = document.getElementById('csvBtn');
      const sheetsBtn = document.getElementById('sheetsBtn');
      const batchInput = document.getElementById('batchInput');
      const emailToggle = document.getElementById('emailToggle');
      const winstonLogo = document.getElementById('winstonLogo');
      const resultCount = document.getElementById('resultCount');
      const currentCount = document.getElementById('currentCount');
      const loadMoreSection = document.getElementById('loadMoreSection');
      const loadMoreBtn = document.getElementById('loadMoreBtn');
      
      let mode = 'keyword';
      let currentPage = 1;
      const itemsPerPage = 10; // Default to 10 results per page

      // Mode switching logic
      const modeRadios = document.getElementsByName('mode');
      modeRadios.forEach(radio => {
        radio.addEventListener('change', () => {
          mode = document.querySelector('input[name="mode"]:checked').value;
          winston.setMode(mode);
          
          urlInput.value = '';
          batchInput.value = '';
          resultsWrapper.classList.add('hidden');
          exportDropdown.classList.add('hidden');
          loadMoreSection.classList.add('hidden');
          currentPage = 1;
          currentCount.textContent = '0';
          
          // Toggle input visibility
          if (mode === 'batch') {
            urlInput.classList.add('hidden');
            batchInput.classList.remove('hidden');
            batchInput.placeholder = 'üöÄ Enter keywords (one per line):\nwomen in stem investors\nfemale tech entrepreneurs\ndiversity venture capital\nwomen startup founders\nfemale angel investors';
          } else {
            urlInput.classList.remove('hidden');
            batchInput.classList.add('hidden');
            if (mode === 'url') {
              urlInput.placeholder = 'üåê Enter website URL (e.g., https://all-raise.org)';
            } else {
              urlInput.placeholder = 'üîç Enter keyword or search term (e.g., women venture capital)';
            }
          }
        });
      });

      // Professional loading states
      function startLoadingAnimation() {
        const loadingText = document.getElementById('loadingText');
        const progressFill = document.getElementById('progressFill');
        
        const progressSteps = [
          { text: "üîç Initiating search...", progress: 10 },
          { text: "üåê Analyzing web sources...", progress: 30 },
          { text: "üìä Extracting contact data...", progress: 60 },
          { text: "üè∑Ô∏è Applying AI categorization...", progress: 80 },
          { text: "‚ú® Finalizing results...", progress: 95 }
        ];
        
        let stepIndex = 0;
        const updateProgress = () => {
          if (stepIndex < progressSteps.length) {
            const step = progressSteps[stepIndex];
            loadingText.textContent = step.text;
            progressFill.style.width = `${step.progress}%`;
            stepIndex++;
          }
        };
        
        updateProgress();
        return setInterval(updateProgress, 800);
      }

      function completeLoading(progressInterval) {
        clearInterval(progressInterval);
        const loadingText = document.getElementById('loadingText');
        const progressFill = document.getElementById('progressFill');
        
        loadingText.textContent = "üéâ Search completed successfully!";
        progressFill.style.width = "100%";
        
        return new Promise(resolve => setTimeout(resolve, 800));
      }

      function resetLoading() {
        const loadingText = document.getElementById('loadingText');
        const progressFill = document.getElementById('progressFill');
        
        progressFill.style.width = "0%";
        loadingText.textContent = "Initializing search...";
      }

      // Main scrape function using Winston module
      async function scrape() {
        let value;
        if (mode === 'batch') {
          value = batchInput.value.trim();
          if (!value) return;
        } else {
          value = urlInput.value.trim();
        if (!value) return;
        }

        scrapeBtn.disabled = true;
        loader.classList.remove('hidden');
        resultsWrapper.classList.add('hidden');
        resultsBox.textContent = '';
        exportDropdown.classList.add('hidden');
        exportMenu.classList.add('hidden');
        loadMoreSection.classList.add('hidden');
        currentPage = 1;
        currentCount.textContent = '0';

        const progressInterval = startLoadingAnimation();

        try {
          const data = await winston.scrape(value, { mode });
          const rows = data.rows || [];
          
          await completeLoading(progressInterval);

          // Render results using the same table structure
          resultsBox.innerHTML = '';
          if (rows && rows.length) {
            const wrapper = document.createElement('div');
            wrapper.className = 'h-96 overflow-y-auto bg-slate-900 rounded-lg shadow-inner';
            const table = document.createElement('table');
            table.className = 'w-full table-auto';
            table.innerHTML = `
              <thead class="text-left font-semibold border-b border-slate-600/50 sticky top-0 z-10">
                <tr class="bg-slate-800">
                  <th class="px-4 py-4 text-sm font-semibold text-gray-200">Contact Name</th>
                  <th class="hidden sm:table-cell px-4 py-4 text-sm font-semibold text-gray-200">Company</th>
                  <th class="hidden md:table-cell px-4 py-4 text-sm font-semibold text-gray-200">Website URL</th>
                  <th class="px-4 py-4 text-sm font-semibold text-gray-200">Email Address</th>
                  <th class="hidden sm:table-cell px-4 py-4 text-sm font-semibold text-gray-200">Phone Number</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-slate-600/30">
              ${rows.map((r, index) => {
                let hostname = '';
                try { hostname = new URL(r.url).hostname.replace(/^www\./, ''); } catch {}
                const firstEmail = (r.emails || '').split(';')[0] || '';
                const firstPhone = (r.phones || '').split(';')[0] || '';
                
                return `
                  <tr class="hover:bg-slate-700/30 transition-all duration-200 group" style="animation: fadeInUp 0.3s ease-out ${index * 0.05}s both">
                    <td class="px-4 py-4 min-w-[120px]">
                      <div class="font-semibold text-white mb-1 group-hover:text-lime-300 transition-colors" title="${r.contact || ''}">${r.contact || 'Unknown Contact'}</div>
                      <div class="text-xs text-gray-400 sm:hidden" title="${hostname}">${hostname}</div>
                    </td>
                    <td class="hidden sm:table-cell px-4 py-4 text-gray-300 min-w-[140px] font-medium" title="${hostname}">${hostname}</td>
                    <td class="hidden md:table-cell px-4 py-4 min-w-[200px]">
                      <a href="${r.url}" target="_blank" class="text-blue-400 hover:text-blue-300 text-sm break-all transition-colors duration-200 hover:underline" title="${r.url || ''}">${r.url}</a>
                    </td>
                    <td class="px-4 py-4 min-w-[160px]">
                      <div class="text-sm text-gray-200 mb-1 font-mono" title="${firstEmail}">${firstEmail}</div>
                      ${firstPhone ? `<a href="tel:${firstPhone.replace(/[^\d+]/g, '')}" class="text-xs text-green-400 hover:text-green-300 sm:hidden cursor-pointer transition-colors duration-200" title="Call ${firstPhone}">${firstPhone}</a>` : ''}
                    </td>
                    <td class="hidden sm:table-cell px-4 py-4 text-sm min-w-[120px]">
                      ${firstPhone ? `<a href="tel:${firstPhone.replace(/[^\d+]/g, '')}" class="text-green-400 hover:text-green-300 cursor-pointer transition-colors duration-200 font-mono" title="Call ${firstPhone}">${firstPhone}</a>` : ''}
                    </td>
                  </tr>`;
              }).join('')}
              </tbody>`;
            wrapper.appendChild(table);
            resultsBox.appendChild(wrapper);
            
            // Add fade-in animation CSS if not already added
            if (!document.getElementById('fadeInAnimationStyle')) {
              const style = document.createElement('style');
              style.id = 'fadeInAnimationStyle';
              style.textContent = `
                @keyframes fadeInUp {
                  from {
                    opacity: 0;
                    transform: translateY(20px);
                  }
                  to {
                    opacity: 1;
                    transform: translateY(0);
                  }
                }
              `;
              document.head.appendChild(style);
            }
          }
          
          resultsWrapper.classList.remove('hidden');
          if (rows && rows.length > 0) {
            exportDropdown.classList.remove('hidden');
            currentCount.textContent = rows.length;
            currentCount.classList.remove('hidden');
          }
          
        } catch (err) {
          clearInterval(progressInterval);
          // Professional error handling
          const errorMessage = err.message || 'An unexpected error occurred. Please try again.';
          
          resultsBox.innerHTML = `
            <div class="p-8 text-center">
              <div class="text-red-400 text-6xl mb-4">‚ö†Ô∏è</div>
              <h3 class="text-xl font-semibold text-white mb-2">Search Encountered an Issue</h3>
              <p class="text-gray-300 mb-4">${errorMessage}</p>
              <button onclick="location.reload()" class="bg-lime-500 hover:bg-lime-400 text-gray-900 font-semibold px-6 py-2 rounded-lg transition">
                Try Again
              </button>
            </div>
          `;
          resultsWrapper.classList.remove('hidden');
          currentCount.textContent = '0';
          currentCount.classList.remove('hidden');
        } finally {
          loader.classList.add('hidden');
          scrapeBtn.disabled = false;
          resetLoading();
        }
      }

      // Event listeners
      scrapeBtn.addEventListener('click', scrape);
      urlInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') scrape();
      });

      // Export dropdown toggle
      exportBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        exportMenu.classList.toggle('hidden');
      });

      document.addEventListener('click', () => {
        exportMenu.classList.add('hidden');
      });

      // Export handlers using Winston module
      csvBtn.addEventListener('click', () => {
        try {
          winston.exportCSV();
        } catch (err) {
          alert(err.message);
        }
        exportMenu.classList.add('hidden');
      });

      xlsxBtn.addEventListener('click', () => {
        try {
          alert('XLSX export is temporarily unavailable. Downloading as CSV instead.');
          winston.exportCSV(`winston-results-excel-${Date.now()}.csv`);
        } catch (err) {
          alert(err.message);
        }
        exportMenu.classList.add('hidden');
      });

      sheetsBtn.addEventListener('click', () => {
        try {
          const result = winston.exportToSheets();
          setTimeout(() => {
            alert(`üìÅ ${result.instructions}`);
          }, 500);
        } catch (err) {
          alert(err.message);
        }
        exportMenu.classList.add('hidden');
      });

      // Email column visibility toggle
      emailToggle.addEventListener('change', () => {
        const show = emailToggle.checked;
        document.querySelectorAll('#resultsWrapper table').forEach(tbl => {
            const emailHeaders = tbl.querySelectorAll('thead th:nth-child(4)');
            emailHeaders.forEach(th => th.style.display = show ? '' : 'none');
            
            const emailCells = tbl.querySelectorAll('tbody td:nth-child(4)');
            emailCells.forEach(td => td.style.display = show ? '' : 'none');
          });
      });

      // Load more functionality
      loadMoreBtn.addEventListener('click', async () => {
        loadMoreBtn.disabled = true;
        loadMoreSection.classList.remove('hidden');
        loader.classList.remove('hidden');
        resultsBox.textContent = '';
        exportDropdown.classList.add('hidden');
        exportMenu.classList.add('hidden');

        const progressInterval = startLoadingAnimation();

        try {
          const data = await winston.scrape(value, { mode, page: currentPage + 1 });
          const rows = data.rows || [];

          await completeLoading(progressInterval);

          resultsBox.innerHTML += `
            <div class="h-96 overflow-y-auto bg-slate-900 rounded-lg shadow-inner">
              <table class="w-full table-auto">
                <thead class="text-left font-semibold border-b border-slate-600/50 sticky top-0 z-10">
                  <tr class="bg-slate-800">
                    <th class="px-4 py-4 text-sm font-semibold text-gray-200">Contact Name</th>
                    <th class="hidden sm:table-cell px-4 py-4 text-sm font-semibold text-gray-200">Company</th>
                    <th class="hidden md:table-cell px-4 py-4 text-sm font-semibold text-gray-200">Website URL</th>
                    <th class="px-4 py-4 text-sm font-semibold text-gray-200">Email Address</th>
                    <th class="hidden sm:table-cell px-4 py-4 text-sm font-semibold text-gray-200">Phone Number</th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-slate-600/30">
                ${rows.map((r, index) => {
                  let hostname = '';
                  try { hostname = new URL(r.url).hostname.replace(/^www\./, ''); } catch {}
                  const firstEmail = (r.emails || '').split(';')[0] || '';
                  const firstPhone = (r.phones || '').split(';')[0] || '';
                  
                  return `
                    <tr class="hover:bg-slate-700/30 transition-all duration-200 group" style="animation: fadeInUp 0.3s ease-out ${index * 0.05}s both">
                      <td class="px-4 py-4 min-w-[120px]">
                        <div class="font-semibold text-white mb-1 group-hover:text-lime-300 transition-colors" title="${r.contact || ''}">${r.contact || 'Unknown Contact'}</div>
                        <div class="text-xs text-gray-400 sm:hidden" title="${hostname}">${hostname}</div>
                      </td>
                      <td class="hidden sm:table-cell px-4 py-4 text-gray-300 min-w-[140px] font-medium" title="${hostname}">${hostname}</td>
                      <td class="hidden md:table-cell px-4 py-4 min-w-[200px]">
                        <a href="${r.url}" target="_blank" class="text-blue-400 hover:text-blue-300 text-sm break-all transition-colors duration-200 hover:underline" title="${r.url || ''}">${r.url}</a>
                      </td>
                      <td class="px-4 py-4 min-w-[160px]">
                        <div class="text-sm text-gray-200 mb-1 font-mono" title="${firstEmail}">${firstEmail}</div>
                        ${firstPhone ? `<a href="tel:${firstPhone.replace(/[^\d+]/g, '')}" class="text-xs text-green-400 hover:text-green-300 sm:hidden cursor-pointer transition-colors duration-200" title="Call ${firstPhone}">${firstPhone}</a>` : ''}
                      </td>
                      <td class="hidden sm:table-cell px-4 py-4 text-sm min-w-[120px]">
                        ${firstPhone ? `<a href="tel:${firstPhone.replace(/[^\d+]/g, '')}" class="text-green-400 hover:text-green-300 cursor-pointer transition-colors duration-200 font-mono" title="Call ${firstPhone}">${firstPhone}</a>` : ''}
                      </td>
                    </tr>`;
                }).join('')}
                </tbody>
              </table>
            </div>
          `;
          currentPage++;
          currentCount.textContent = rows.length + (currentPage - 1) * itemsPerPage;
          currentCount.classList.remove('hidden');

          // Add fade-in animation CSS if not already added
          if (!document.getElementById('fadeInAnimationStyle')) {
            const style = document.createElement('style');
            style.id = 'fadeInAnimationStyle';
            style.textContent = `
              @keyframes fadeInUp {
                from {
                  opacity: 0;
                  transform: translateY(20px);
                }
                to {
                  opacity: 1;
                  transform: translateY(0);
                }
              }
            `;
            document.head.appendChild(style);
          }

        } catch (err) {
          clearInterval(progressInterval);
          const errorMessage = err.message || 'An unexpected error occurred. Please try again.';
          resultsBox.innerHTML = `
            <div class="p-8 text-center">
              <div class="text-red-400 text-6xl mb-4">‚ö†Ô∏è</div>
              <h3 class="text-xl font-semibold text-white mb-2">Search Encountered an Issue</h3>
              <p class="text-gray-300 mb-4">${errorMessage}</p>
              <button onclick="location.reload()" class="bg-lime-500 hover:bg-lime-400 text-gray-900 font-semibold px-6 py-2 rounded-lg transition">
                Try Again
              </button>
            </div>
          `;
          loadMoreSection.classList.add('hidden');
          loadMoreBtn.disabled = false;
        } finally {
          loader.classList.add('hidden');
          loadMoreBtn.disabled = false;
          resetLoading();
        }
      });

      // Winston logo clear/reset functionality
      winstonLogo.addEventListener('click', () => {
        urlInput.value = '';
        batchInput.value = '';
        resultsWrapper.classList.add('hidden');
        exportDropdown.classList.add('hidden');
        exportMenu.classList.add('hidden');
        loadMoreSection.classList.add('hidden');
        resultsBox.innerHTML = '';
        scrapeBtn.disabled = false;
        loader.classList.add('hidden');
        
        winston.clearResults();
        
        document.querySelector('input[value="keyword"]').checked = true;
        mode = 'keyword';
        winston.setMode('keyword');
        
        urlInput.classList.remove('hidden');
        batchInput.classList.add('hidden');
        urlInput.placeholder = 'üîç Enter keyword or search term (e.g., women venture capital)';
        
        urlInput.focus();
        console.log('Winston AI: Interface cleared and reset');
      });
    </script>
  </body>
</html> 